mixin custom-table(headers, items, tableName)
    table(class='table table-striped table-bordered table-sm' id=tableName)
        thead
            tr
                each header, index in Object.keys(headers)
                    th(scop='col' data-tabname=tableName data-index=index onclick="sortTable(event)" style="cursor: pointer")= header
        tbody
            each item in items
                tr
                    each header in Object.keys(headers)
                        td= item[headers[header]]


doctype html
html(lang="en")
    head
        link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css", integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH", crossorigin="anonymous")
        title Week #{weekNum} Stats
    body
        script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js" integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous")

        div(class="container")
            h1(class='display-4') Week #{weekNum}
            h5(class='text-body-secondary') Click column headers to sort
            div(class='card mb-5')
                div(class='card-body')
                    h5(class='card-title') Weekly Player Rankings
                    h6(class='card-subtitle mb-2 text-body-secondary') Only includes rostered players
                    nav
                        div(class="nav nav-tabs" id="nav-tab" role="tablist")
                            button(class="nav-link active" data-bs-toggle="tab" data-bs-target="#wp-nav-qb" type="button" ) QB
                            button(class="nav-link" data-bs-toggle="tab" data-bs-target="#wp-nav-wr" type="button" ) WR
                            button(class="nav-link" data-bs-toggle="tab" data-bs-target="#wp-nav-rb" type="button" ) RB
                            button(class="nav-link" data-bs-toggle="tab" data-bs-target="#wp-nav-te" type="button" ) TE
                    div(class="tab-content" id="nav-tabContent")
                        div(class="tab-pane fade show active" id="wp-nav-qb"  tabindex="0")    
                            +custom-table(qbRanksHeaders, qbRanks, 'wp-qb')
                        div(class="tab-pane fade" id="wp-nav-wr" tabindex="0")
                            +custom-table(wrRanksHeaders, wrRanks, 'wp-wr')
                        div(class="tab-pane fade" id="wp-nav-rb" tabindex="0")
                                +custom-table(rbRanksHeaders, rbRanks, 'wp-rb')
                        div(class='tab-pane fade' id='wp-nav-te' tabindex='0')
                            +custom-table(teRanksHeaders, teRanks, 'wp-te')
            div(class='card mb-5')
                div(class='card-body')
                    h5(class='card-title') Weekly Positional Group Points Breakdown
                    h6(class='card-subtitle mb-2 text-body-secondary') Only includes starting players
                    div
                        +custom-table(teamPgPointsHeaders, teamPgPoints, 'pg-points')             
            div(class='card mb-5')
                div(class='card-body')
                    h5(class='card-title') King/Queen of the Bench
                    h6(class='card-subtitle mb-2 text-body-secondary') Includes all positions
                    +custom-table(teamBenchHeaders, teamBench, 'bench-table')
        script.
            function sortTable( event) {
                let rows, i, x, y, shouldSwitch,                
                switching = true,
                sortTable = event.target.dataset.tabname
                sortIndex = event.target.dataset.index,
                table = document.getElementById(sortTable);
                /*Make a loop that will continue until
                no switching has been done:*/
                while (switching) {
                    //start by saying: no switching is done:
                    switching = false;
                    rows = table.rows;
                    /*Loop through all table rows (except the
                    first, which contains table headers):*/
                    for (i = 1; i < (rows.length - 1); i++) {
                        //start by saying there should be no switching:
                        shouldSwitch = false;
                        /*Get the two elements you want to compare,
                        one from current row and one from the next:*/
                        x = rows[i].getElementsByTagName("TD")[sortIndex];
                        y = rows[i + 1].getElementsByTagName("TD")[sortIndex];
                        //check if the two rows should switch place:
                        if(isNaN(x.innerHTML)) {
                            if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                                //if so, mark as a switch and break the loop:
                                shouldSwitch = true;
                                break;
                            }
                        } else {
                            if(+x.innerHTML < + y.innerHTML) {
                                 //if so, mark as a switch and break the loop:
                                shouldSwitch = true;
                                break;
                            }
                        }
                        
                    }
                    if (shouldSwitch) {
                        /*If a switch has been marked, make the switch
                        and mark that a switch has been done:*/
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                        switching = true;
                    }
                }
            }
                